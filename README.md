# Chinese Writer - Obsidian 插件

一个专为中文写作设计的 Obsidian 插件，可以将指定目录下的 Markdown 文件以树状结构的方式展示在右侧边栏中。

## 功能特性

### 📚 智能文档树

- **三层树状结构**：
  - 第一层：目录下的所有 Markdown 文件
  - 第二层：每个文件中的所有 H1 标题
  - 第三层：每个 H1 下的所有 H2 标题（不包括孤立的 H2）

### 🎯 数据读取

插件会自动解析并显示：
1. 指定目录下的所有 Markdown 文件
2. 文件中的所有 H1 标题
3. H1 下的所有 H2 标题（孤立的 H2 不包括）
4. H2 下的所有内容行（H2 和下一个 H1 之间，或两个 H2 之间的内容）

### 🎨 界面设计

- **标题栏**：
  - 中间显示文件夹图标和目录名
  - 右侧有全部展开/折叠按钮
  
- **树状显示区**：
  - 独立滚动条
  - 清晰的层级缩进
  - 可展开/折叠的节点
  - 不同层级使用不同的图标和样式

## 安装方法

### 手动安装

1. 将插件文件夹复制到你的 Obsidian 仓库的 `.obsidian/plugins/` 目录下
2. 确保文件夹中包含以下文件：
   - `main.js`
   - `manifest.json`
   - `styles.css`
3. 在 Obsidian 中打开 **设置 → 社区插件**
4. 关闭安全模式（如果已开启）
5. 在已安装插件列表中找到 "Chinese Writer" 并启用

### 开发模式安装

1. 克隆此仓库到 `.obsidian/plugins/` 目录
2. 运行 `npm install` 安装依赖
3. 运行 `npm run dev` 启动开发模式（自动监听文件变化）
4. 或运行 `npm run build` 进行生产构建

## 使用方法

### 1. 配置目标文件夹

1. 打开 **设置 → Chinese Writer**
2. 在 "目标文件夹" 中输入你想要读取的文件夹路径（相对于仓库根目录）
   - 例如：`小说/第一部` 或 `Projects/Novel`
3. 设置会自动保存并刷新视图

### 2. 打开文档树视图

有三种方式打开视图：

1. **命令面板**：
   - 按 `Ctrl/Cmd + P` 打开命令面板
   - 输入 "打开文档树视图"
   - 选择并执行

2. **功能区图标**：
   - 点击左侧功能区的书本图标

3. **自动打开**：
   - 插件加载时会自动在右侧边栏打开视图

### 3. 使用树状视图

- **展开/折叠节点**：点击节点前的箭头图标
- **全部展开/折叠**：点击标题栏右侧的按钮
- **查看内容**：点击节点可以查看详细信息（在控制台中）

## 文件结构要求

为了让插件正确解析你的文档，请遵循以下结构：

```markdown
# 第一章

## 第一节

这里是第一节的内容。
可以有多行。

## 第二节

这里是第二节的内容。

# 第二章

## 第一节

第二章第一节的内容。
```

**注意事项**：
- 使用标准的 Markdown 标题语法（`#` 后面要有空格）
- H2 必须在 H1 下面才会被收集
- 孤立的 H2（没有上级 H1）会被忽略
- H2 下的内容会被收集，直到遇到下一个标题

## 开发

### 项目结构

```
src/
├── main.ts          # 插件入口，生命周期管理
├── types.ts         # TypeScript 类型定义
├── settings.ts      # 设置界面和配置
├── parser.ts        # Markdown 文件解析器
└── tree-view.ts     # 树状视图组件
```

### 构建命令

```bash
# 开发模式（监听文件变化）
npm run dev

# 生产构建
npm run build

# 代码检查
npm run lint
```

### 技术栈

- TypeScript
- Obsidian API
- esbuild（打包工具）

## 许可证

0-BSD License

## 作者

pingo8888

## 贡献

欢迎提交 Issue 和 Pull Request！

## 更新日志

### 0.1.0 (初始版本)

- ✨ 实现基本的树状结构显示
- ✨ 支持三层文档结构（文件 → H1 → H2）
- ✨ 可配置的目标文件夹
- ✨ 全部展开/折叠功能
- 🎨 美观的界面设计
